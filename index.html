<!DOCTYPE html>
<!-- ç‰ˆæœ¬: 1.1 -->
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡Œæ”¿ç¨‹åºå·¥å…·ç®±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { background-color: #f8fafc; font-family: 'Noto Sans TC', sans-serif; }
        .card { background: white; border-radius: 24px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.05), 0 10px 10px -5px rgba(0,0,0,0.02); }
        .tab-active { color: #2563eb; border-bottom: 3px solid #2563eb; }
        .btn-active { background-color: #2563eb !important; color: white !important; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }
        input:focus { border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
    </style>
</head>
<body class="p-4 md:p-12">
    <div class="max-w-md mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-2xl font-black text-slate-800 tracking-tight">è¡Œæ”¿ç¨‹åºå·¥å…·ç®±</h1>
            <p class="text-slate-400 text-sm mt-1">æ³•è¦éµå¾ªè¨ˆç®—å™¨</p>
        </header>

        <div class="card overflow-hidden border border-slate-100">
            <div class="flex border-b border-slate-50 bg-slate-50/30">
                <button onclick="switchMode('calc')" id="tab-calc" class="flex-1 py-5 text-sm font-bold text-slate-400 transition-all tab-active">ğŸ—“ï¸ æœŸé–“è¨ˆç®—</button>
                <button onclick="switchMode('overdue')" id="tab-overdue" class="flex-1 py-5 text-sm font-bold text-slate-400 transition-all">âš ï¸ é€¾æœŸæª¢æŸ¥</button>
            </div>

            <div class="p-8">
                <div class="mb-8">
                    <label class="block text-[11px] font-black text-slate-400 mb-3 uppercase tracking-widest">æ¡ˆä»¶æ³•å¾‹æ€§è³ª</label>
                    <div class="flex bg-slate-100 p-1.5 rounded-2xl">
                        <button onclick="setType('normal')" id="btn-normal" class="btn-active flex-1 py-2.5 rounded-xl text-sm font-bold transition-all">ä¸€èˆ¬æ¡ˆä»¶</button>
                        <button onclick="setType('adverse')" id="btn-adverse" class="flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500 transition-all">ä¸åˆ©è™•åˆ†</button>
                    </div>
                    <div id="type-desc-box" class="mt-3 p-3 bg-blue-50/50 rounded-lg">
                        <p id="type-desc" class="text-xs text-blue-700 leading-relaxed font-medium">â€» ä¾è¡Œæ”¿ç¨‹åºæ³•ç¬¬48æ¢ï¼šå§‹æ—¥ä¸è¨ˆï¼Œæœ«æ—¥é‡å‡æ—¥é †å»¶ã€‚</p>
                    </div>
                </div>

                <div id="section-calc" class="space-y-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-600 mb-2">é€é”æ—¥æœŸ (ç™¼ç”Ÿæ—¥)</label>
                        <input type="date" id="startDate" class="w-full p-4 rounded-2xl border border-slate-200 outline-none transition-all">
                    </div>
                    <div class="flex gap-4">
                        <div class="flex-[2]">
                            <label class="block text-xs font-bold text-slate-600 mb-2">æ³•å®šæœŸé–“</label>
                            <input type="number" id="periodValue" value="30" class="w-full p-4 rounded-2xl border border-slate-200 outline-none transition-all">
                        </div>
                        <div class="flex-1">
                            <label class="block text-xs font-bold text-slate-600 mb-2">å–®ä½</label>
                            <select id="periodUnit" class="w-full p-4 rounded-2xl border border-slate-200 bg-white outline-none transition-all appearance-none">
                                <option value="day">æ—¥</option>
                                <option value="month">æœˆ</option>
                                <option value="year">å¹´</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="runCalc()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-[0.98]">è¨ˆç®—å±†æ»¿æ—¥</button>
                </div>

                <div id="section-overdue" class="space-y-6 hidden">
                    <div>
                        <label class="block text-xs font-bold text-slate-600 mb-2">å¯¦éš›è™•ç†æ—¥æœŸ</label>
                        <input type="date" id="date1" class="w-full p-4 rounded-2xl border border-slate-200 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-600 mb-2">åŸå§‹æ•ˆæœŸæˆªæ­¢æ—¥</label>
                        <input type="date" id="date2" class="w-full p-4 rounded-2xl border border-slate-200 outline-none transition-all">
                    </div>
                    <button onclick="runOverdue()" class="w-full bg-slate-800 hover:bg-black text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-[0.98]">è¨ˆç®—é€¾æœŸç‹€æ³</button>
                </div>

                <div id="result-area" class="mt-8 hidden animate-in fade-in slide-in-from-bottom-4 duration-500">
                    <div id="status-card" class="p-6 rounded-3xl border transition-all">
                        <div id="res-title" class="text-[10px] font-black uppercase tracking-[0.2em] mb-2"></div>
                        <div id="res-main" class="text-3xl font-black mb-1"></div>
                        <div id="res-sub" class="text-sm font-bold opacity-90"></div>
                        <div id="res-total-days" class="text-xs font-bold mt-3 py-1 px-3 bg-white/50 rounded-full inline-block"></div>
                        <div id="res-detail" class="text-xs mt-4 leading-relaxed border-t border-current/10 pt-4"></div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="mt-8 text-center text-[10px] text-slate-400 font-medium">
            æœ¬å·¥å…·åƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›æœŸé™æ‡‰ä»¥å„è©²ç®¡æ©Ÿé—œèªå®šç‚ºæº–ã€‚
        </footer>
    </div>

    <script>
        // æ“´å±•ç¯€å‡æ—¥è³‡æ–™è‡³ 2026 
        const HOLIDAY_DATA = {"2026":["1011000001100000110000011000001","1000001100000111111111000011","1000001100000110000011000001100","001111000011000001100000110000","1110000011000001100000110000011","000001100000110000111000001100","0001100000110000011000001100000","1100000110000011000001100000110","000011000001100000110000111100","0011000011100000110000011100001","100000110000011000001100000110","0000110000011000001100001110000"]};
        
        let currentType = 'normal', currentMode = 'calc';
        const weekNames = ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­"];

        function switchMode(m) {
            currentMode = m;
            document.getElementById('section-calc').classList.toggle('hidden', m !== 'calc');
            document.getElementById('section-overdue').classList.toggle('hidden', m !== 'overdue');
            document.getElementById('tab-calc').className = m === 'calc' ? 'flex-1 py-5 text-sm font-bold tab-active' : 'flex-1 py-5 text-sm font-bold text-slate-400';
            document.getElementById('tab-overdue').className = m === 'overdue' ? 'flex-1 py-5 text-sm font-bold tab-active' : 'flex-1 py-5 text-sm font-bold text-slate-400';
            document.getElementById('result-area').classList.add('hidden');
        }

        function setType(t) {
            currentType = t;
            document.getElementById('btn-normal').className = t === 'normal' ? 'btn-active flex-1 py-2.5 rounded-xl text-sm font-bold transition-all' : 'flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500';
            document.getElementById('btn-adverse').className = t === 'adverse' ? 'btn-active flex-1 py-2.5 rounded-xl text-sm font-bold transition-all' : 'flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500';
            document.getElementById('type-desc').innerText = t === 'normal' ? "â€» ä¾è¡Œæ”¿ç¨‹åºæ³•ç¬¬48æ¢ï¼šå§‹æ—¥ä¸è¨ˆï¼Œæœ«æ—¥é‡å‡æ—¥é †å»¶ã€‚" : "â€» ä¸åˆ©è™•åˆ†ï¼šå§‹æ—¥è¨ˆå…¥ï¼ˆç¬¬ä¸€æ—¥å³ç”Ÿæ•ˆï¼‰ï¼Œæœ«æ—¥é‡å‡æ—¥ä¸é †å»¶ã€‚";
        }

        function isHoliday(date) {
            const y = date.getFullYear(), m = date.getMonth(), d = date.getDate();
            if (HOLIDAY_DATA[y]) return HOLIDAY_DATA[y][m].charAt(d - 1) === "1";
            return (date.getDay() === 0 || date.getDay() === 6);
        }

        function getLocalDateStr(date) {
            return date.toLocaleDateString('zh-TW', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\//g, '-');
        }

        function runCalc() {
            const s = document.getElementById('startDate').value;
            if (!s) return;
            const p = parseInt(document.getElementById('periodValue').value);
            const u = document.getElementById('periodUnit').value;
            let parts = s.split('-');
            let start = new Date(parts[0], parts[1]-1, parts[2]);
            let end = new Date(start);

            if (currentType === 'normal') {
                if (u === 'day') end.setDate(end.getDate() + p);
                else if (u === 'month') end.setMonth(end.getMonth() + p);
                else end.setFullYear(end.getFullYear() + p);
                
                let skip = 0;
                while (isHoliday(end)) { end.setDate(end.getDate() + 1); skip++; }
                var detail = `æ³•å¾‹ä¾æ“šï¼šè¡Œæ”¿ç¨‹åºæ³•ç¬¬48æ¢ã€‚å§‹æ—¥ä¸è¨ˆå…¥è¨ˆç®—ã€‚` + (skip > 0 ? ` æœ«æ—¥é€¢å‡æ—¥é †å»¶ ${skip} å¤©è‡³è¾¦å…¬æ—¥ã€‚` : " æœ«æ—¥éå‡æ—¥ï¼Œä¸é †å»¶ã€‚");
            } else {
                if (u === 'day') end.setDate(end.getDate() + (p - 1));
                else { 
                    end.setMonth(end.getMonth() + (u==='month'?p:0)); 
                    end.setFullYear(end.getFullYear() + (u==='year'?p:0)); 
                    end.setDate(end.getDate() - 1); 
                }
                var detail = "æ³•å¾‹æ€§è³ªï¼šä¸åˆ©è™•åˆ†ã€‚ä¾è¡Œæ”¿ç¨‹åºæ³•ç¬¬48æ¢ç¬¬2é …ä½†æ›¸ï¼Œå§‹æ—¥è¨ˆå…¥ã€‚æœ«æ—¥ä¸é©ç”¨å‡æ—¥é †å»¶è¦å®šã€‚";
            }
            const totalCovered = Math.round((end - start)/864e5) + 1;
            showResult("å±†æ»¿æ—¥æœŸ (æœ«æ—¥)", getLocalDateStr(end), weekNames[end.getDay()], detail, "blue", `ç¸½æ¶µè“‹ï¼š${totalCovered} å¤©`);
        }

        function runOverdue() {
            const v1 = document.getElementById('date1').value, v2 = document.getElementById('date2').value;
            if (!v1 || !v2) return;
            
            let d1 = new Date(v1);
            let dead = new Date(v2);
            let legalDead = new Date(dead);
            let skipDesc = "";
            
            if (currentType === 'normal') {
                let cnt = 0;
                while (isHoliday(legalDead)) { legalDead.setDate(legalDead.getDate() + 1); cnt++; }
                skipDesc = cnt > 0 ? `åŸæˆªæ­¢æ—¥é€¢å‡æ—¥ï¼Œä¾æ³•é †å»¶è‡³ ${getLocalDateStr(legalDead)}ã€‚` : "æœ«æ—¥éå‡æ—¥ï¼Œä¸é †å»¶ã€‚";
            } else {
                skipDesc = "ä¸åˆ©è™•åˆ†ï¼šæœŸé™ä¸å› å‡æ—¥é †å»¶ã€‚";
            }

            if (d1 > legalDead) {
                let overdueDays = 0;
                let temp = new Date(legalDead);
                temp.setDate(temp.getDate() + 1);
                while (temp <= d1) {
                    if (!isHoliday(temp)) overdueDays++;
                    temp.setDate(temp.getDate() + 1);
                }
                showResult("ç‹€æ…‹ï¼šé€¾æœŸä¸­", `${overdueDays} å€‹å·¥ä½œæ—¥`, `æ³•å®šæˆªæ­¢æ—¥ï¼š${getLocalDateStr(legalDead)}`, skipDesc + " (é€¾æœŸè¨ˆç®—å·²æ‰£é™¤å‡æ—¥)", "rose", "");
            } else {
                showResult("ç‹€æ…‹ï¼šæ•ˆæœŸå…§", `å°šæœªé€¾æœŸ`, `æ³•å®šæˆªæ­¢æ—¥ï¼š${getLocalDateStr(legalDead)}`, skipDesc, "emerald", "");
            }
        }

        function showResult(t, m, s, d, color, total) {
            const area = document.getElementById('result-area');
            area.classList.remove('hidden');
            document.getElementById('res-title').innerText = t;
            document.getElementById('res-main').innerText = m;
            document.getElementById('res-sub').innerText = s;
            document.getElementById('res-detail').innerText = d;
            const tBox = document.getElementById('res-total-days');
            tBox.innerText = total || ""; tBox.classList.toggle('hidden', !total);
            const themes = { 
                blue: "bg-blue-50 text-blue-700 border-blue-200", 
                rose: "bg-red-50 text-red-700 border-red-200", 
                emerald: "bg-emerald-50 text-emerald-700 border-emerald-200" 
            };
            document.getElementById('status-card').className = `p-6 rounded-3xl border ${themes[color]}`;
            area.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // åˆå§‹åŒ–ç•¶å¤©æ—¥æœŸ
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('startDate').value = today;
        document.getElementById('date1').value = today;
        document.getElementById('date2').value = today;
    </script>
</body>
</html>
